# Item 75

# 에외의 상세 메세지에 실패 관련 정보를 담으라

**실패 관련 정보를 담아야 하는 이유**

예외를 잡지 못해 프로그램이 실패하면 자바 시스템은 그 예외의 스택 추적 정보를 자동으로 출력한다. 스택 추적은 예외 객체의 toString 메서드를 호출해 얻는 문자열로, 보통은 예외의 클래스 이름 뒤에 상세 메세지가 붙는 형태다.

더구나 그 실패를 재현하기 어렵다면 더 자세한 정보를 얻기가 어렵거나 불가능하다. 따라서 예외의 toString 메서드에 실패 원인에 관한 정보를 가능한 많이 담아 반환하는 것이 중요하다. 사후 분석을 위해 실패 순간의 상황을 정확히 포착해 예외의 상세 메세지에 담아야한다.

**실패 순간을 포착하려면 발생한 예외에 관여된 모든 매개변수와 필드값을 실패 메세지에 담아야한다.**

예컨데, IndexOutOfBoundsException의 상세 메세지는 범위의 최대, 최소 값과 범위를 벗어난 인덱스 값을 담아야 한다. 셋중 한, 두개 혹은 세개가 모두 잘못됐을 수 있다. 이렇게 다른 원인으로 실패한 경우들을 모두 포착할 수 있으므로 무엇을 고쳐야 할지 분석하는데 큰 도움이된다.

```java
public IndextOutOfBoundsException(int lowerBound, int upperBound, int index){
	// 실패를 포착하는 상세 메시지를 생성한다.
    super(String.format(
    		"최솟값: %d, 최댓값: %d, 인덱스: %d",
            lowrBound, upperBound, index));
	
    // 프로그램에서 이용할 수 있도록 실패 정보를 저장한다
    this.lowerBound = lowerBound;
    this.upperBound = upperBound;
    this.index = index;
}
```

위의 코드와 같이 실패를 적절히 포착하려면 필요한 정보를 예외 생성자에서 모두 받아서 상세 메세지까지 미리 생성해 놓는 방법도 좋다. IndextOutOfBoundsException은 String을 받지만, 위의 코드처럼 구현했어도 좋았을 것이다.

**장황하지 않게 데이터를 담아라**

관련 데이터를 모두 담아야 하나 장황할 필요는 없다. 문제를 분석하는 사람은 여러 자료를 살펴볼 것이다.

- 스택 추적 : 예외가 발생한 파일과 줄번호 + 스택에서 호출한 다른 메서드들의 파일 이름과 줄 번호
- 관련 문서
- 소스코드

따라서 소스코드에서 얻을 수 있는 정보는 길게 늘어나봐야 군더더기가 된다.

**예외의 상세 메세지와 최종 사용자에게 보여줄 오류 메세지를 혼동해서는 안된다.**

최종 사용자에게는 친절한 안내 메세지를 보여주어야 하지만 예외 메세지는 가독성 보다 담긴 내용이 훨씬 중요하다. 또한 사용자용 메세지는 현지어로 번역해주기도 하지만, 예외 메세지는 그런일이 거의 없다.